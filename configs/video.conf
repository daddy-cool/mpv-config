vo=gpu-next
gpu-api=vulkan
vulkan-swap-mode=fifo-relaxed
hwdec=nvdec-copy#auto-copy-safe#auto-safe
vd-lavc-film-grain=gpu
hdr-compute-peak=yes
allow-delayed-peak-detect=no
deband-iterations=4
deband-threshold=96
deband-range=32
sigmoid-upscaling=yes
dither-depth=8
scale=oversample
scale-param1=0.5 #for scale=oversample: 0 will always interpolate edges, 0.5 will never interpolate (aka regular nearest neighbour)

# Luma downscaling
#glsl-shader='~~/shaders/SSimDownscaler.glsl' #do not use with linear-downscaling
linear-downscaling=yes #do not use with SSimDownscaler shader
correct-downscaling=yes
dscale=catmull_rom

# Chroma Scaling
#glsl-shader='~~/shaders/KrigBilateral.glsl' #KrigBilateral
cscale=lanczos

# Grain
deband-grain=0 #deband-grain must be zero if grain shader is used
glsl-shader='~~/shaders/brightness_adaptive_filmgrain_smooth.glsl'


[luma_scale]
profile-cond=(p['display-height'] % p['video-params/dh'])~=0 and (p['display-width'] % p['video-params/dw'])~=0
profile-restore=copy-equal
# === Scaling === Scaler Comparision: https://artoriuz.github.io/blog/mpv_upscaling.html
#glsl-shader='~~/shaders/ravu-lite-ar-r4.glsl'
#glsl-shader='~~/shaders/ravu-zoom-ar-r3.glsl'
#glsl-shader='~~/shaders/FSRCNNX_x2_8-0-4-1.glsl' #Prescaler (x2) based on layered convolutional networks
scale=lanczos


[hdr10]
profile-cond=p['video-params/colormatrix']=='bt.2020-ncl'
profile-restore=copy-equal
deband-iterations=1
deband-threshold=48
deband-range=16


[dolby_vision]
profile-cond=p['video-params/colormatrix']=='dolbyvision'
profile-restore=copy-equal
deband=no #should not be needed for dolby vision


[hdr]
profile-cond=p['video-params/colormatrix']=='bt.2020-ncl' or p['video-params/colormatrix']=='dolbyvision'
profile-restore=copy-equal
glsl-shader-opts-append=grain_intensity=0.05 #reduce grain shader intensity for HDR


#[4k]
#profile-cond=p['dheight']>1440
#profile-restore=copy-equal


[8k]
profile-cond=p['video-params/dh']>2160
profile-restore=copy-equal
deband=no #too expensive in 8K for now