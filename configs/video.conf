vo=gpu-next
gpu-api=vulkan
vulkan-swap-mode=fifo-relaxed
hwdec=auto-safe#nvdec-copy
vd-lavc-film-grain=gpu
hdr-compute-peak=yes
video-sync=display-resample
allow-delayed-peak-detect=no
deband-iterations=4
deband-threshold=96
interpolation
tscale=oversample
sigmoid-upscaling=yes

# === Scaling === Scaler Comparision: https://artoriuz.github.io/blog/mpv_upscaling.html

# Luma Upscaling
#glsl-shader='~~/shaders/ravu-lite-ar-r4.glsl'
#glsl-shader='~~/shaders/ravu-zoom-ar-r3.glsl'
glsl-shader='~~/shaders/FSRCNNX_x2_8-0-4-1.glsl' # Prescaler (x2) based on layered convolutional networks
scale=lanczos

# Luma downscaling
#glsl-shader='~~/shaders/SSimDownscaler.glsl' # do not use with linear-downscaling
linear-downscaling=yes # do not use with SSimDownscaler shader
correct-downscaling=yes
dscale=catmull_rom

# Chroma Scaling
#glsl-shader='~~/shaders/KrigBilateral.glsl' # KrigBilateral
cscale=lanczos

# Grain
deband-grain=0 # disable deband-grain if grain shader is used
glsl-shader='~~/shaders/brightness_adaptive_filmgrain_smooth.glsl' # disable deband-grain if used


[hdr10]
profile-cond=p['video-params/colormatrix']=='bt.2020-ncl'
profile-restore=copy-equal
glsl-shader-opts-append=grain_intensity=0.08 # reduce grain intensity for HDR
deband-threshold=12


[dolby_vision]
profile-cond=p['video-params/colormatrix']=='dolbyvision'
profile-restore=copy-equal
profile=hdr10
deband=no # should not be needed for dolby vision


[4k]
profile-cond=p['video-params/dh']>1440
profile-restore=copy-equal
deband-iterations=1


[8k]
profile-cond=p['video-params/dh']>2160
profile-restore=copy-equal
deband=no # too expensive in 8K
#glsl-shaders-remove='~~/shaders/KrigBilateral.glsl' # too expensive in 8K
#cscale=lanczos # default ewa_lanczos would be too expensive in 8K